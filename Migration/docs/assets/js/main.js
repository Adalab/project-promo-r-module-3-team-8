"use strict";const resetBtn=document.querySelector(".js-reset-btn"),formElement=document.querySelector(".js-form"),nameInput=document.querySelector(".js-input-name"),jobInput=document.querySelector(".js-input-job"),emailInput=document.querySelector(".js-input-email"),phoneInput=document.querySelector(".js-input-phone"),linkedinInput=document.querySelector(".js-input-linkedin"),githubInput=document.querySelector(".js-input-github"),boxInput=document.querySelector(".js-input-box"),previewArticleTitle=document.querySelector(".js-article-title"),previewArticleSubtitle=document.querySelector(".js-article-subtitle"),previewArticlePhoto=document.querySelector(".js-article-photo"),previewArticlePhone=document.querySelector(".js-article-link-phone"),previewArticleMail=document.querySelector(".js-article-link-mail"),previewArticleLinkedin=document.querySelector(".js-article-link-linkedin"),previewArticleGitHub=document.querySelector(".js-article-link-github"),previewArticleElement=document.querySelector(".js-article"),paletteOne=document.querySelector(".js-palette-one"),paletteTwo=document.querySelector(".js-palette-two"),paletteThree=document.querySelector(".js-palette-three"),createButton=document.querySelector(".js-create-button"),shareResultBox=document.querySelector(".js-share-result-box"),shareUrl=document.querySelector(".js-share-url"),linkTwitter=document.querySelector(".js-link-twitter"),designHead=document.querySelector(".js-design-head"),designBigBox=document.querySelector(".js-design-big-box"),fillHead=document.querySelector(".js-fill-head"),fillBigBox=document.querySelector(".js-fill-big-box"),shareHead=document.querySelector(".js-share-head"),shareBigBox=document.querySelector(".js-share-big-box"),designArrowUp=document.querySelector(".js-design-arrow-up"),designArrowDown=document.querySelector(".js-design-arrow-down"),fillArrowUp=document.querySelector(".js-fill-arrow-up"),fillArrowDown=document.querySelector(".js-fill-arrow-down"),shareArrowUp=document.querySelector(".js-share-arrow-up"),shareArrowDown=document.querySelector(".js-share-arrow-down"),allHead=[designHead,fillHead,shareHead],fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");let data={palette:"1",name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:""};function checkTarget(e,t){"name"===e?data.name=t:"job"===e?data.job=t:"phone"===e?data.phone=t:"email"===e?data.email=t:"linkedin"===e?data.linkedin=t:"github"===e&&(data.github=t)}function updatePreview(e){""===e.name?previewArticleTitle.innerHTML="Minion Stuart":previewArticleTitle.innerHTML=e.name,""===e.job?previewArticleSubtitle.innerHTML="Despicable villain":previewArticleSubtitle.innerHTML=e.job,""===e.phone?previewArticlePhone.href="tel:#":previewArticlePhone.href="tel:"+e.phone,""===e.email?previewArticleMail.href="mailto:#":previewArticleMail.href="mailto:"+e.email,""===e.linkedin?previewArticleLinkedin.href="#":previewArticleLinkedin.href="https://www.linkedin.com/in/"+e.linkedin,""===e.github?previewArticleGitHub.href="#":previewArticleGitHub.href="https://github.com/"+e.github}function handleInput(e){checkTarget(e.target.name,e.target.value),updatePreview(data),localStorage.setItem("datainputs",JSON.stringify(data))}function checkPalette(e){previewArticleElement.classList.remove("palette-1"),previewArticleElement.classList.remove("palette-2"),previewArticleElement.classList.remove("palette-3"),previewArticleElement.classList.add("palette-"+e.currentTarget.value),data.palette=e.currentTarget.value}function reviewClickPlace(e){switch(e){case fillHead:fillBigBox.classList.remove("collapsed"),fillArrowUp.classList.add("collapsed"),fillArrowDown.classList.remove("collapsed");break;case shareHead:shareBigBox.classList.remove("collapsed"),shareArrowUp.classList.add("collapsed"),shareArrowDown.classList.remove("collapsed");break;case designHead:designBigBox.classList.remove("collapsed"),designArrowUp.classList.add("collapsed"),designArrowDown.classList.remove("collapsed")}}function addClass(){designBigBox.classList.add("collapsed"),fillBigBox.classList.add("collapsed"),shareBigBox.classList.add("collapsed"),designArrowUp.classList.remove("collapsed"),designArrowDown.classList.add("collapsed"),fillArrowUp.classList.remove("collapsed"),fillArrowDown.classList.add("collapsed"),shareArrowUp.classList.remove("collapsed"),shareArrowDown.classList.add("collapsed")}function handleClick(e){e.preventDefault(),addClass(),reviewClickPlace(e.currentTarget)}formElement.addEventListener("input",handleInput),resetBtn.addEventListener("click",e=>{e.preventDefault(),nameInput.value="",jobInput.value="",emailInput.value="",phoneInput.value="",linkedinInput.value="",githubInput.value="",boxInput.style="",previewArticleTitle.innerHTML="Minion Stuart",previewArticleSubtitle.innerHTML="Despicable villain",previewArticlePhoto.style="./images/b8766cd53b5e1529712ed7e49365b7d4.jpg",previewArticlePhone.href="tel:#",previewArticleMail.href="mailto:#",previewArticleLinkedin.href="#",previewArticleGitHub.href="#",paletteOne.checked=!0,previewArticleElement.classList.remove("palette-2"),previewArticleElement.classList.remove("palette-3"),previewArticleElement.classList.add("palette-1"),linkTwitter.href="#",shareUrl.href="#",shareUrl.innerHTML="",shareResultBox.classList.add("collapsed"),createButton.classList.add("createbutton-on"),shareBigBox.classList.add("collapsed"),shareArrowUp.classList.remove("collapsed"),shareArrowDown.classList.add("collapsed"),fillBigBox.classList.add("collapsed"),fillArrowUp.classList.remove("collapsed"),fillArrowDown.classList.add("collapsed"),designBigBox.classList.remove("collapsed"),designArrowUp.classList.add("collapsed"),designArrowDown.classList.remove("collapsed"),data={palette:"1",name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:""},savedData=localStorage.setItem("datainputs",JSON.stringify(data)),savedData=localStorage.removeItem("datainputs"),emailInput.style.border="medium solid #f8e055",phoneInput.style.border="medium solid #f8e055",linkedinInput.style.border="medium solid #f8e055",githubInput.style.border="medium solid #f8e055";for(const e of allInvalids)e.classList.add("js-hidden")}),paletteOne.addEventListener("click",checkPalette),paletteTwo.addEventListener("click",checkPalette),paletteThree.addEventListener("click",checkPalette);for(let e of allHead)e.addEventListener("click",handleClick);function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,data.photo=fr.result,localStorage.setItem("datainputs",JSON.stringify(data))}function handleCreateClick(e){e.preventDefault(),fetch("https://awesome-profile-cards.herokuapp.com/card",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)}).then(e=>e.json()).then(e=>{if(e.success){createButton.classList.remove("createbutton-on"),createButton.classList.add("createbutton-of"),shareResultBox.classList.remove("collapsed");const t=e.cardURL;linkTwitter.href="https://twitter.com/intent/tweet?text=Hola,%20os%20comparto%20mi%20tarjeta:%0a&url="+t,shareUrl.href=t,shareUrl.innerHTML=t}else{showAlert();const e=document.querySelectorAll(".js-alert-btn"),l=document.querySelectorAll(".js-alert-box");function t(){for(const e of l)e.classList.add("js-remove")}for(const l of e)l.addEventListener("click",t);shareBigBox.classList.add("collapsed"),shareArrowUp.classList.remove("collapsed"),shareArrowDown.classList.add("collapsed"),fillBigBox.classList.remove("collapsed"),fillArrowUp.classList.add("collapsed"),fillArrowDown.classList.remove("collapsed")}})}fileField.addEventListener("change",getImage),createButton.addEventListener("click",handleCreateClick);let savedData=localStorage.getItem("datainputs");function renderData(e){nameInput.value=e.name,jobInput.value=e.job,emailInput.value=e.email,phoneInput.value=e.phone,linkedinInput.value=e.linkedin,githubInput.value=e.github,"1"===e.palette&&(paletteOne.checked=!0,previewArticleElement.classList.add("palette-1"),previewArticleElement.classList.remove("palette-2"),previewArticleElement.classList.remove("palette-3")),"2"===e.palette&&(paletteTwo.checked=!0,previewArticleElement.classList.remove("palette-1"),previewArticleElement.classList.add("palette-2"),previewArticleElement.classList.remove("palette-3")),"3"===e.palette&&(paletteThree.checked=!0,previewArticleElement.classList.remove("palette-1"),previewArticleElement.classList.remove("palette-2"),previewArticleElement.classList.add("palette-3")),updatePreview(e),""!==e.photo&&(profileImage.style.backgroundImage=`url(${e.photo})`,profilePreview.style.backgroundImage=`url(${e.photo})`)}function addInvalidMsg(e){for(const t of allInvalids)t.id===e.id&&t.classList.remove("js-hidden")}function delInvalidMsg(e){for(const t of allInvalids)t.id===e.id&&t.classList.add("js-hidden")}null!==savedData&&(data=JSON.parse(savedData),renderData(data)),emailInput.addEventListener("input",e=>{e.preventDefault();const t=e.currentTarget.value;!0!==/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(t)?(emailInput.style.border="medium solid #d96863",addInvalidMsg(e.currentTarget)):(emailInput.style.border="medium solid #f8e055",delInvalidMsg(e.currentTarget))}),phoneInput.addEventListener("change",e=>{e.preventDefault();const t=e.currentTarget.value;!0!==/^([+]?[\s0-9]+)?(\d{3}|[(]?[0-9]+[)])?([-]?[\s]?[0-9])+$/.test(t)?(phoneInput.style.border="medium solid #d96863",addInvalidMsg(e.currentTarget)):(phoneInput.style.border="medium solid #f8e055",delInvalidMsg(e.currentTarget))}),linkedinInput.addEventListener("input",e=>{e.preventDefault();const t=e.currentTarget.value;!0!==/^[a-zA-Z0-9._-]{5,30}$/.test(t)?(linkedinInput.style.border="medium solid #d96863",addInvalidMsg(e.currentTarget)):(linkedinInput.style.border="medium solid #f8e055",delInvalidMsg(e.currentTarget))}),githubInput.addEventListener("input",e=>{e.preventDefault();const t=e.currentTarget.value;!0!==/^[a-zA-Z0-9._-]{5,30}$/.test(t)?(githubInput.style.border="medium solid #d96863",addInvalidMsg(e.currentTarget)):(githubInput.style.border="medium solid #f8e055",delInvalidMsg(e.currentTarget))});let allInvalids=[];function addInvalidEl(){const e=document.querySelectorAll(".fill__div__input");for(const t of e){const e=document.createElement("small");e.setAttribute("class","js-invalid-msg js-hidden"),e.setAttribute("id",t.id);const l=document.createTextNode("*Campo no válido");e.appendChild(l),t.parentNode.insertBefore(e,t.nextSibling),allInvalids.push(e)}}function showAlert(){const e=document.createElement("div");e.setAttribute("class","js-alert-box");const t=document.createElement("p");t.setAttribute("class","js-alert-text");const l=document.createTextNode("Oops! Te queda algún campo por rellenar... Tank yu!");t.appendChild(l);const r=document.createElement("button");r.setAttribute("class","js-alert-btn");const a=document.createTextNode("Banana");r.appendChild(a),e.appendChild(t),e.appendChild(r);document.querySelector("body").appendChild(e)}addInvalidEl();